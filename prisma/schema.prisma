datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum Network {
  ETHEREUM
  BSC
  POLYGON
}

model Token {
  id                    String                  @id
  network               Network
  address               String
  decimals              Int                     @db.SmallInt
  symbol                String
  logoUri               String?
  usdPriceHistoric      TokenUsdPriceHistoric[] @relation("TokenUsdPriceHistoric")
  priceHistoryUpdatedAt DateTime                @default(now())
  createdAt             DateTime                @default(now())
  updatedAt             DateTime                @updatedAt

  @@unique([network, address])
  @@index([network, address])
}

model TokenUsdPriceHistoric {
  tokenId   String
  token     Token    @relation("TokenUsdPriceHistoric", fields: [tokenId], references: [id])
  at        DateTime
  price     Decimal  @db.Decimal(65, 20)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@id([tokenId, at])
}
